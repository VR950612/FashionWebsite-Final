<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shopping Cart</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet"/>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

<!-- Bootstrap JS and jQuery (before closing </body>) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>   
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>

   </head>
  <body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
          <a class="navbar-brand" href="/" style="font-size:50px; color: rgba(250, 38, 102, 0.901)">
            Fashion Fiesta
          </a>
        </div>
      
        <!-- Main Navbar Links -->
        <ul class="navbar-nav d-flex flex-row ms-auto" style="padding-right: 80px;">
            {% if session['logged_in_user'] %}
              <!-- If user is logged in, show Welcome, Logout, and Categories -->
              <li class="nav-item">
                <a href="#">Welcome, {{ session['logged_in_user'].get('first_name', 'Guest') }}</a>
              </li>
                    
              <!-- Categories Dropdown (only visible when logged in) -->
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle custom-font-size" style="margin-right: 60px;" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Categories
                </a>
                <!-- Dropdown menu that appears under "Categories" -->
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/category-name/Dress"><b>Dresses</b></a>
                    <a class="dropdown-item" href="/category-name/Top"><b>Tops</b></a>
                    <a class="dropdown-item" href="/category-name/Skirt"><b>Skirts</b></a>
                    <a class="dropdown-item" href="/category-name/Jumpsuit"><b>Jumpsuits</b></a>
                </div>
            </li>
            {% else %}
              <!-- If user is not logged in, only show Categories -->
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle custom-font-size" style="margin-right: 60px;" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Categories
                </a>
                <!-- Dropdown menu for Categories (still available when logged out) -->
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/category-name/Dress"><b>Dresses</b></a>
                  <a class="dropdown-item" href="/category-name/Top"><b>Tops</b></a>
                  <a class="dropdown-item" href="/category-name/Skirt"><b>Skirts</b></a>
                  <a class="dropdown-item" href="/category-name/Jumpsuit"><b>Jumpsuits</b></a>
                </div>
              </li>
            {% endif %}
        
            <!-- Item in Cart dropdown (this can be shown regardless of login status) -->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle custom-font-size" style="margin-right: 60px; white-space: nowrap;" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Item in Cart
              </a>
              <!-- Add cart items dropdown or content here -->
            </li>
          </ul>
        </nav>
        <style>
            html, body {
                height: 170%; 
                margin: 0; 
                background-color: #222;
            }
        
            .navbar {
                margin-bottom: 20px;
            }
        
            .nav {
                border-right: 1px solid white;
            }
        
            .form-container {
                padding: 40px 20px; /* Add top padding */
                border-radius: 5px;
            }
        
            .form-container h1 {
                margin-bottom: 10px;
            }
        
            .table-custom {
                max-width: 850px; 
                width: 100%; 
                margin-left: 60px; 
                margin-right: 0px; 
            }
        
            .btn-margin {
                margin-top: 10px;
            }
        
            .custom-font-size {
                font-size: 14px; 
            }
            .nav-item .nav-link {
                color: white !important; 
                text-align: left;
            }
        
            .navbar .dropdown-menu {
                background-color: #222 !important; 
                border: none; 
            }
        
            .navbar .dropdown-item {
                color: white !important;
                background-color: #222 !important; 
            }
            .navbar .dropdown-item:hover,
            .navbar .dropdown-item:focus {
                background-color: #222 !important; 
                color: white !important;
            }
            .navbar-nav .nav-item {
                white-space: nowrap; 
            }
            .nav-link {
                font-size: 17px;
                color: white;
            }
        </style>
    </head>
 <body>
<div class="container" style="margin-left: 400px;">
    <h1>Products</h1>
    <div class="row">
           <div class="col-sm-6 col-md-4 col-lg-3 mb-4">
            <a href="" class="card-link"> <!-- Add anchor tag here -->
                <div class="card">
                    <img src="" class="card-img-top" alt="}">
                    <div class="card-body">
                        <h5 class="card-title"></h5>
                        <p class="card-text"></p>
                        <p class="card-text">Price: $</p>
                        <a href="#" class="btn btn-primary">View Details</a>
                    </div>
                </div>
            </a> <!-- Close anchor tag here -->
        </div>
    </div>
</div>

</body>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Bootstrap JS and Popper.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
$(document).ready(function() {
    // Event handler for category links
    $('.category-link').click(function(e) {
        e.preventDefault(); // Prevent default navigation behavior
        var categoryId = $(this).attr('href').split('/').pop(); // Extract category ID from href attribute
        // AJAX request to fetch products for the selected category
        $.ajax({
            url: '/products/' + categoryId,
            type: 'GET',
            success: function(response) {
                $('#product-list').html(response); // Update product list with retrieved products
            },
            error: function(xhr, status, error) {
                console.error('Error fetching products:', error);
            }
        });
    });
});


$(document).ready(function() {
        $('.category-link').click(function(e) {
            e.preventDefault(); // Prevent default navigation behavior
            var categoryId = $(this).attr('href').split('/').pop(); // Extract category ID from href attribute
            $.ajax({
                url: '/userproduct/' + categoryId,
                type: 'GET',
                success: function(response) {
                    $('#userproduct').html(response); // Update product list with retrieved products
                },
                error: function(xhr, status, error) {
                    console.error('Error fetching products:', error);
                }
            });
        });
    });
</script>
</body>
</html>